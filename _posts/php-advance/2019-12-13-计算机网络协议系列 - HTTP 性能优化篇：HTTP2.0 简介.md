---
title: 计算机网络协议系列 - HTTP 性能优化篇：HTTP/2.0 简介

layout: post

category: blog

tags: |-

  PHP

  计算机网络协议系列
  
  HTTP 协议篇

HTTP2.0
---



# 计算机网络协议系列（五十五）



目前主流的 HTTP 通信都是基于 HTTP/1.1 的，而 HTTP/1.1 自 1999 年发布的 [RFC2616](https://www.ietf.org/rfc/rfc2616.txt) 之后再未进行过修订，而随着互联网的蓬勃发展，HTTP/1.1 自身所暴露的问题也越来越多，于是负责互联网技术标准的 IETF 组织创建了专门的工作组来推进下一代 HTTP —— HTTP/2.0 的标准化，其首要目标就是解决 HTTP 的性能瓶颈，缩短 Web 页面的加载时间。

HTTP/1.1 的性能瓶颈主要有以下这些：

- 一条连接同时只能发送一个请求；
- 请求只能从客户端发起；
- 请求/响应首部未经压缩就直接发送，首部信息越多延迟越大；
- 每次请求/响应都会发送冗长的首部信息，造成通信的浪费；

为了解决这些问题，HTTP/2.0 会对 HTTP 首部（或者叫做 HTTP 头）进行一定的压缩，将原来每次通信都要携带的大量头信息（键值对）在两端建立一个索引表，对相同的头只发送索引表中的索引。

另外，HTTP/2.0 协议会将一个 TCP 连接切分成多个流，每个流都有自己的 ID，而且流可以是客户端发往服务端，也可以是服务端发往客户端，为了解决并发请求导致响应慢的问题，还可以为流设置优先级。HTTP/2.0 还将所有的传输信息分割为更小的消息和帧，并对它们采用二进制格式编码，常见的帧有 Header 帧，用于传输 HTTP 头信息，并且会开启一个新的流；再就是 Data 帧，用来传输 HTTP 报文实体，多个 Data 帧属于同一个流。

通过这两种机制，HTTP/2.0 的客户端可以将多个请求分到不同的流中，以实现在一个 TCP 连接上处理所有请求，然后将请求内容拆分成帧，进行二进制传输，这些帧可以打散乱序发送，然后根据每个帧首部的流标识符重新组装，并且可以根据优先级，决定优先处理哪个流的数据。

这样一来，HTTP/2.0 成功消除了 HTTP/1.1 的性能瓶颈和限制，减少了 TCP 连接数对服务器性能的影响，同时可以将页面的多个 css、js、 图片等资源打包成一个数据连接进行传输，能够加快页面组件的传输速度。

HTTP/2.0 虽然大大增加了并发性，但并不完美，因为 HTTP/2.0 还是基于 TCP 协议的，TCP 协议在建立连接时有额外的开销，在处理包时有严格的顺序要求，当其中一个数据包遇到问题，TCP 连接需要等待这个包完成重传之后才能继续进行。要解决这些问题只能通过 UDP 协议来实现才可以最大化提升 Web 的性能，不过这就属于另一个话题了。

HTTP/2.0 标准于 2015 年以 [RFC7540](https://www.ietf.org/rfc/rfc7540.txt) 正式发表，具体的标准化工作由 Chrome、Opera、Firefox、IE、Safari、Edge 等浏览器提供支持，目前主流浏览器都已经支持了该协议。